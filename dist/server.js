!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=3)}([function(e,t){e.exports=require("express-msteams-host")},function(e,t){e.exports=require("botbuilder")},function(e,t,o){"use strict";var n=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,o,s):r(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},r=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?r(e.value):new o((function(t){t(e.value)})).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=o(0),s=o(1),a=o(11);let c=class extends s.ActivityHandler{constructor(e,t){super(),this.loggedInMemberOIDs=new Map,this.conversationState=t,this.onInvokeActivity=e=>r(this,void 0,void 0,(function*(){const t=e;let o;const n={tab:{type:"continue",value:{cards:[{card:s.CardFactory.adaptiveCard(a.default).content}]}}};switch(t.activity.name){case"tab/submit":break;case"tab/fetch":default:o=n}return{status:200,body:o}}))}};c=n([i.PreventIframe("/acPrototypeBot/acProtoBotTab.html")],c),t.AcPrototypeBot=c},function(e,t,o){e.exports=o(4)},function(e,t,o){"use strict";var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?r(e.value):new o((function(t){t(e.value)})).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=o(5),i=o(6),s=o(7),a=o(8),c=o(0),u=o(1),p=o(9),d=o(10),l=o(2),f=p("msteams");f("Initializing Microsoft Teams Express hosted App..."),o(13).config();const y=o(14),h=r(),m=process.env.port||process.env.PORT||3007,v=new u.BotFrameworkAdapter({appId:process.env.MICROSOFT_APP_ID,appPassword:process.env.MICROSOFT_APP_PASSWORD});v.onTurnError=(e,t)=>n(this,void 0,void 0,(function*(){console.error("\n [onTurnError] unhandled error: "+t),yield e.sendTraceActivity("OnTurnError Trace",""+t,"https://www.botframework.com/schemas/error","TurnError"),yield e.sendActivity("The bot encountered an error or bug."),yield e.sendActivity("To continue to run this bot, please fix the bot source code."),yield g.delete(e)}));const b=new u.MemoryStorage,g=new u.ConversationState(b),w=new l.AcPrototypeBot(b,g);h.use(r.json({verify:(e,t,o,n)=>{e.rawBody=o.toString()}})),h.use(r.urlencoded({extended:!0})),h.engine("html",d.renderFile),h.set("view engine","ejs"),h.set("views",s.join(__dirname,"/")),h.use(a("tiny")),h.post("/api/messages",(e,t)=>{v.processActivity(e,t,e=>n(this,void 0,void 0,(function*(){yield w.run(e)})))}),h.use("/scripts",r.static(s.join(__dirname,"web/scripts"))),h.use("/assets",r.static(s.join(__dirname,"web/assets"))),h.post("/acPrototypeTab/redirect.html",(e,t)=>{const o=e.body,n=Math.random().toString();b.write({[n]:{idToken:o.id_token,accessToken:o.access_token,tokenType:o.token_type,expiresIn:o.expires_in,scope:o.scope}}),t.render(s.join(__dirname,"web/acPrototypeTab/redirect.ejs"),{state:n,error:o.error})}),h.use(c.MsTeamsApiRouter(y)),h.use(c.MsTeamsPageRouter({root:s.join(__dirname,"web/"),components:y})),h.use("/",r.static(s.join(__dirname,"web/"),{index:"index.html"})),h.set("port",m),i.createServer(h).listen(m,()=>{f("Server running on "+m)})},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("morgan")},function(e,t){e.exports=require("debug")},function(e,t){e.exports=require("ejs")},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(12);t.default=n},function(e){e.exports={type:"AdaptiveCard",body:[{type:"Container",bleed:!0,style:"emphasis",items:[{type:"TextBlock",text:"Actions Done Today",weight:"Bolder",size:"Medium"}]},{type:"ColumnSet",columns:[{type:"Column",items:[{type:"Image",url:"https://www.predicagroup.com/app/uploads/2019/08/AzureDevOpsLogo-300x300.png",size:"Small"}],width:"auto"},{type:"Column",items:[{type:"TextBlock",weight:"Bolder",text:"Task Module - Implementation",wrap:!0},{type:"TextBlock",spacing:"None",text:"Contribution time: 4 hr, 15 min",isSubtle:!0,wrap:!0,fontType:"Default",weight:"Lighter"}],width:"stretch",height:"stretch"}],separator:!0,spacing:"Small"},{type:"ActionSet",actions:[{type:"Action.ShowCard",title:"Set goal",card:{type:"AdaptiveCard",body:[{type:"Input.ChoiceSet",id:"goal",style:"expanded",choices:[{title:"Commited goals âœ¨",value:"commited-goals"},{title:"Collaboration ðŸ’¡",value:"collaboration"},{title:"Mentoring ðŸ’Ž",value:"mentoring"}],label:"Choose the right goal for the action:",isRequired:!0}],actions:[{type:"Action.Submit",title:"OK",data:{FoodChoice:"Steak"}}]}}]}],$schema:"http://adaptivecards.io/schemas/adaptive-card.json",version:"1.3"}},function(e,t){e.exports=require("dotenv")},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nonce={},function(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}(o(2))}]);
//# sourceMappingURL=server.js.map